From a31dbbb17b56e31d91ac8746fb395a368d02a575 Mon Sep 17 00:00:00 2001
From: Roman Stratiienko <r.stratiienko@gmail.com>
Date: Tue, 11 Apr 2023 23:31:52 +0300
Subject: [PATCH 5/5] RPI4: FFMPEG: Enable hardware codecs

Signed-off-by: Roman Stratiienko <r.stratiienko@gmail.com>
---
 ffmpeg.mk | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/ffmpeg.mk b/ffmpeg.mk
index 9574291..bce3f99 100644
--- a/ffmpeg.mk
+++ b/ffmpeg.mk
@@ -43,6 +43,13 @@ AOSPEXT_GEN_PKGCONFIGS += dav1d:$(DAV1D_VERSION)
 FFMPEG_DEFINITIONS += --enable-libdav1d
 endif
 
+ifneq ($(filter true, $(BOARD_FFMPEG_ENABLE_REQUEST_API)),)
+LOCAL_SHARED_LIBRARIES += libdrm libudev
+FFMPEG_GEN_PKGCONFIGS += libdrm libudev
+FFMPEG_DEFINITIONS += --enable-libdrm --enable-libudev --enable-v4l2-request --enable-sand
+LOCAL_C_INCLUDES := vendor/devices-community/gd_rpi4/codecs/request_api_headers_v3
+endif
+
 AOSPEXT_EXPORT_INSTALLED_INCLUDE_DIRS := vendor/include
 
 #-------------------------------------------------------------------------------
-- 
2.39.2

